---
title: "Database Performance Improvements"
room: "OP SIG"
chair: "deeznnutz"
chairId: "@deeznnutz:zenon.chat"
startTime: "2024-11-19T18:59:59.000Z"
endTime: "2024-11-19T19:38:39.000Z"
duration: "38 minutes"
participants:
  - "@coinselor:zenon.chat"
  - "@deeznnutz:zenon.chat"
  - "@vilkris:hc1.chat"
participantStats:
  - userId: "@deeznnutz:zenon.chat"
    displayName: "deeznnutz"
    messageCount: 57
  - userId: "@vilkris:hc1.chat"
    displayName: "vilkris"
    messageCount: 21
  - userId: "@coinselor:zenon.chat"
    displayName: "coinselor"
    messageCount: 11
roomId: "#sig-op:hc1.chat"
published: "2025-07-21T19:54:02.930Z"
---

Tue, Nov 19, 2024, 18:59:59 - deeznnutz: === START OP SIG 19 NOV 2024 ===
Tue, Nov 19, 2024, 19:00:00 - deeznnutz: GM
Tue, Nov 19, 2024, 19:00:22 - vilkris: Gm
Tue, Nov 19, 2024, 19:00:32 - coinselor: hihi
Tue, Nov 19, 2024, 19:00:41 - deeznnutz: I think we can move quickly today. thx for pushing it one day
Tue, Nov 19, 2024, 19:00:58 - deeznnutz: vilkris: I went through your update. Is there anything you wanted to add.
Tue, Nov 19, 2024, 19:01:05 - deeznnutz: I have a proposed test
Tue, Nov 19, 2024, 19:01:36 - vilkris: Not much to add, but I do think it's good if others can replicate the results
Tue, Nov 19, 2024, 19:01:55 - deeznnutz: Proposed test to confirm Vilkris' results

1\) Test 1: sync `go-zenon` directly on this machine - Supermicro SuperServer 5018D-FN8T Xeon D 1U Rackmount,10GbE,SFP+,32GB & 512GB M.2

2\) Test 2: install proxmox on the same machine, and allocate 100% of the available resources to a single VM and perform the same sync

Tue, Nov 19, 2024, 19:02:02 - deeznnutz: what do you think about this test?
Tue, Nov 19, 2024, 19:02:28 - deeznnutz: with this we can determine if the hypervisor is causing an issue
Tue, Nov 19, 2024, 19:02:57 - vilkris: Sounds good to me. I'm not an expert in that area
Tue, Nov 19, 2024, 19:03:40 - vilkris: It's also easy for anyone to confirm by syncing the node locally on their machine
Tue, Nov 19, 2024, 19:04:16 - vilkris: I was supposed to try the sync on a Mac M1 but didn't get around to that yet
Tue, Nov 19, 2024, 19:04:26 - deeznnutz: I have a lot of crap going on with my mac. I wanted to isolate that and use a clean machine so nothing else is competing for resources
Tue, Nov 19, 2024, 19:04:37 - coinselor: George highlighted the need to not just take sync times at face value but attach each test to comprehensive specs:

"Probably want to give details like:

cloud provider
vm type
specs"

Does the troubleshooting script deeznnutz you made output this information? If not, I can look into adding any missing information to it that might be useful. Maybe some internet speed test?

Tue, Nov 19, 2024, 19:05:14 - deeznnutz: <@coinselor:zenon.chat "George highlighted the need to n..."> it does not. but that is a good idea
Tue, Nov 19, 2024, 19:05:31 - deeznnutz: i did not have inet speed or ping. those could be helpful for sure
Tue, Nov 19, 2024, 19:06:36 - deeznnutz: I'll run this test. On this server. I'm literally setting it up now. At a minimum we can determine if a hypervisor is causing an issue. if not we can start testing more stuff / options.
Tue, Nov 19, 2024, 19:07:58 - vilkris: <@coinselor:zenon.chat "George highlighted the need to n..."> Regarding the different specs on cloud providers we might also want to add a way to time the sync from height 1 to some pre defined height, like 8M
Tue, Nov 19, 2024, 19:08:27 - vilkris: Otherwise it's hard to accurately time the sync
Tue, Nov 19, 2024, 19:08:51 - deeznnutz: is there something you can do to stop the sync at 8m and implement a simple timer?
Tue, Nov 19, 2024, 19:09:47 - vilkris: Without modifying go-zenon I'm not sure
Tue, Nov 19, 2024, 19:10:07 - deeznnutz: we can parse the logs
Tue, Nov 19, 2024, 19:10:25 - vilkris: Yeah that might work
Tue, Nov 19, 2024, 19:10:26 - coinselor: couldn't we hack it to kill the process parsing the grafana logs znnd_exporter george is making?
Tue, Nov 19, 2024, 19:10:28 - deeznnutz: I can do it with a bash script just watching the logs
Tue, Nov 19, 2024, 19:11:05 - deeznnutz: I can also use monit.
Tue, Nov 19, 2024, 19:11:20 - deeznnutz: let me see what I can hack together without touching go-zenon
Tue, Nov 19, 2024, 19:11:41 - vilkris: The logs seem like the easiest approach
Tue, Nov 19, 2024, 19:11:48 - deeznnutz: ya, agree
Tue, Nov 19, 2024, 19:12:26 - vilkris: They are timestamped I think it should record when a momentum is inserted, at least on the debug level
Tue, Nov 19, 2024, 19:13:02 - vilkris: Just need to also record the first momentum's time as well
Tue, Nov 19, 2024, 19:13:20 - deeznnutz: yep. I have an idea how to do that really easily.
Tue, Nov 19, 2024, 19:13:27 - vilkris: Okay nice
Tue, Nov 19, 2024, 19:13:41 - vilkris: That would make it easy to compare results if it's always the same amount of momentums
Tue, Nov 19, 2024, 19:14:19 - deeznnutz: Moving on to the troubleshooting flag for our script.
Tue, Nov 19, 2024, 19:14:45 - deeznnutz: The amount of Time I spend on go-zenon trouble shooting is pretty high.  
Tue, Nov 19, 2024, 19:15:31 - coinselor: We might be also able to parse the logs of the time series data the znnd exporter creates to say figure out how long it took to get to a specific milestone like 1M momentums, but I'm not sure.
Tue, Nov 19, 2024, 19:15:54 - deeznnutz: <@coinselor:zenon.chat "We might be also able to parse t..."> that is the work that george is actually working on
Tue, Nov 19, 2024, 19:16:09 - coinselor: as far as I understand it basically just reformats the output from znnd logs
Tue, Nov 19, 2024, 19:17:28 - deeznnutz: george wrote that code in `go` to track the speed of momentum production. This simple script I can use is just temp until george deploys his code and we can visualize it in grafana.  
Tue, Nov 19, 2024, 19:18:20 - deeznnutz: Anything else on this before we move to troubleshooting?
Tue, Nov 19, 2024, 19:18:37 - vilkris: Not from me
Tue, Nov 19, 2024, 19:19:00 - deeznnutz: Cool. So the time required to trouble shoot is very high.
Tue, Nov 19, 2024, 19:19:20 - deeznnutz: people who do not know how to use linux - it's very hard to get basic information.
Tue, Nov 19, 2024, 19:19:31 - deeznnutz: Like... is the hard drive out of space.
Tue, Nov 19, 2024, 19:19:54 - deeznnutz: So I will publsh this script to help with troubleshooting and coinselor maybe you can review and improve
Tue, Nov 19, 2024, 19:20:15 - deeznnutz: My question is, what is the best way to get the output to me without copy / paste
Tue, Nov 19, 2024, 19:20:28 - deeznnutz: we have sever limits on what some can do
Tue, Nov 19, 2024, 19:20:46 - deeznnutz: I was going to try to push the results to a TG bot
Tue, Nov 19, 2024, 19:20:54 - deeznnutz: but need to expose API keys to do that
Tue, Nov 19, 2024, 19:22:24 - coinselor: Yeah, I'm sure we can think of something to publish the data somewhere. There's no sensitive information right? It's basically specs
Tue, Nov 19, 2024, 19:22:45 - deeznnutz: I think george is very reluctatnt to ask pillars to expose their IP
Tue, Nov 19, 2024, 19:23:02 - deeznnutz: I could setup an API to receive the data but it will expose the IP
Tue, Nov 19, 2024, 19:23:11 - deeznnutz: but not to me if they push to TG
Tue, Nov 19, 2024, 19:24:20 - deeznnutz: So I was going to encrypt the TG API keys and use some tool to decrypt them when sending the troubleshooting results to TG
Tue, Nov 19, 2024, 19:24:35 - deeznnutz: but I'm open to suggestions
Tue, Nov 19, 2024, 19:24:49 - coinselor: We should look into it. We can copy paste for now. Maybe there's a good solution using nostr/tor or something.
Tue, Nov 19, 2024, 19:25:21 - deeznnutz: ya maybe we can dive in a little more and see what we can come up with.  
Tue, Nov 19, 2024, 19:26:25 - vilkris: Don't have any ideas off the top of my head. But I can understand that even copy pasting stuff can be a real pain point
Tue, Nov 19, 2024, 19:26:55 - deeznnutz: <@vilkris:hc1.chat "Don't have any ideas off the top..."> ya, I get a lot of screen shots... which is why I would love a file.  
Tue, Nov 19, 2024, 19:27:12 - deeznnutz: Maybe we can take it offline and come up with a solution
Tue, Nov 19, 2024, 19:27:14 - coinselor: <@deeznnutz:zenon.chat "So I will publsh this script to ..."> Sounds good btw. I'll also look into creating a wrapper in go for the scripts as a way for me to get started/familiarized with go. I also wanna make it pretty with that Bubble Tea framework george keeps sharing
Tue, Nov 19, 2024, 19:27:41 - deeznnutz: ya that would be cool. Love that Bubble Tea Framework
Tue, Nov 19, 2024, 19:28:12 - deeznnutz: I have the backup / restore script working well. I just need to submit it for review
Tue, Nov 19, 2024, 19:28:44 - deeznnutz: and george gave an update on his work. He needs to make the dashboard and make the auto-install
Tue, Nov 19, 2024, 19:29:21 - deeznnutz: Finally the HQZ work. I think reusing our scripts for HQZ will be pretty easy
Tue, Nov 19, 2024, 19:30:27 - vilkris: <@deeznnutz:zenon.chat "I have the backup / restore scri..."> I'm assuming this is only for restoring from a local backup?
Tue, Nov 19, 2024, 19:30:32 - deeznnutz: Yes
Tue, Nov 19, 2024, 19:30:52 - deeznnutz: I have a separate one where it pulls from DO, but I'm not going to publish that
Tue, Nov 19, 2024, 19:31:01 - deeznnutz: I backup daily to DO just in case
Tue, Nov 19, 2024, 19:32:48 - vilkris: Okay, just thinking that if the new suggested approach is to sync the node locally then being able to easily transfer the node data onto the server would be useful
Tue, Nov 19, 2024, 19:33:02 - vilkris: Not sure how much work it would be to add that type of functionality to the script
Tue, Nov 19, 2024, 19:33:19 - deeznnutz: actually not that bad
Tue, Nov 19, 2024, 19:33:36 - deeznnutz: its just a .tar, scp, and untar
Tue, Nov 19, 2024, 19:34:02 - deeznnutz: that's what I do today to send to DO, but with the S3CLI
Tue, Nov 19, 2024, 19:34:21 - coinselor: We could look into offering connector's to large cloud providers but I'm sure there's probably tools already built we could leverage. And maybe out of scope.
Tue, Nov 19, 2024, 19:34:46 - deeznnutz: S3CLI is a great tool, but you need an S3 endpoint
Tue, Nov 19, 2024, 19:34:49 - vilkris: Gotcha. Well we can think of that more once we've confirmed that local syncing is a solution
Tue, Nov 19, 2024, 19:34:50 - coinselor: Another minor concern would be an user choosing i.e AWS over others because we have a bootstrap/backup feature on a script or something like that
Tue, Nov 19, 2024, 19:35:52 - deeznnutz: We can add an S3 endpoint for sure. I have that setup today. It just requires an s3 config file.  
Tue, Nov 19, 2024, 19:36:20 - deeznnutz: but maybe we start with local backup and restore and move to S3 and/or SCP based on test results?
Tue, Nov 19, 2024, 19:37:03 - deeznnutz: Anything else to discuss?
Tue, Nov 19, 2024, 19:37:29 - deeznnutz: Next meeting 16 Dec 24 @ 8PM UTC?
Tue, Nov 19, 2024, 19:38:05 - coinselor: Looks good to me. Nothing to add.
Tue, Nov 19, 2024, 19:38:17 - deeznnutz: Cool - thx guys!!
Tue, Nov 19, 2024, 19:38:29 - vilkris: Thanks!
Tue, Nov 19, 2024, 19:38:39 - deeznnutz: === END OP SIG 19 NOV 2024 ===
